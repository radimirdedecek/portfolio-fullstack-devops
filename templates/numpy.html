<h2 id="numpy" class="fw-bold"><img src="static/assets/numpy.svg" alt="Numpy" class="list-icon3 me-2">NumPy Data Preprocessing</h2>
<hr class="hrx"/>
<p class="lead mt-3"></p>
<h4 class="fw-bold text-dark">Test Project: NumPy Data Preprocessing</h4>

<p class="lead mt-3">
    This section showcases the use of the **NumPy** library for fast data manipulation: 
 specifically showing two common preprocessing techniques: Z-Score Standardization and Min-Max Normalization applied to movie scores.
 The data for processing is downloaded in the <a href="#api" class="lead ax">REST API</a> section and cleaned in the <a href="#pandas" class="lead ax">PANDAS</a> section.
</p>

<h5 class="mt-4 fw-bold">Interactive Demo: Run NumPy Analysis (Standardization & Normalization)</h5>
<div class="d-flex align-items-center mb-3">
    <button id="runNumpyAnalysisBtn" class="btn btn-primary btn-lg me-3" style="width: 300px;">
        <i class="fas fa-play me-2"></i> Execute NumPy Analysis
    </button>
</div> 

<!-- Area for the output -->
<div id="numpyResults" class="results-container mt-4 p-3 border border-dark rounded bg-gray overflow-auto" style="max-height: 550px; max-width: 1150px;">
    <p class="text-center text-dark m-0">Click the button to run NumPy Analysis on the TMDB data.</p>
    <!-- The table and stats generated by runNumpyAnalysis will appear here -->
</div>

<h6 class="mt-4 text-white-50">Server-Side Code Snapshot (Python / NumPy Implementation):</h6>
<pre class="p-2 border bg-secondary rounded overflow-auto" style = "max-height: 365px; max-width: 950px;">
<code>######################################################################################
###                                  NUMPY ENDPOINT                                ###
### Standardization (Z-score) and Normalization (Min-Max Scaling) on movie scores. ###
######################################################################################
@app.route('/api/run_numpy_analysis', methods=['GET'])
def run_numpy_analysis():
    raw_data, status_message = load_movie_data(6)
    if not raw_data or not raw_data.get('results'):
        return jsonify({"error": f"Failed to load data for Plotly. Status: {status_message}"}), 500
    try:
        # 1. Prepare Data
        df = pd.DataFrame(raw_data['results'])

        # Filter for numerical stability
        df = df[df['vote_average'].notna() & (df['vote_count'] > 0)].copy()
        
        # Extract the relevant series (Score) into a NumPy array
        scores = df['vote_average'].to_numpy()
        movie_titles = df['title'].tolist()

        if len(scores) < 5:
            return jsonify({"error": "Not enough data points for NumPy analysis."}), 500

        # 2. Standardization (Z-Score): z_scores = (scores - mean) / std_dev
        mean = np.mean(scores)
        std_dev = np.std(scores)
        z_scores = (scores - mean) / std_dev

        # 3. Normalization (Min-Max Scaling): (X - min) / (max - min)
        min_score = np.min(scores)
        max_score = np.max(scores)
        min_max_scores = (scores - min_score) / (max_score - min_score)
        
        # 4. Compile results for the top movies for display
        results = []
        for i in range(NUMPY_DISPLAY_LIMIT):
            if i >= len(scores):
                break
            results.append({
                "title": movie_titles[i],
                "raw": f"{scores[i]:.2f}",
                "z_score": f"{z_scores[i]:.4f}",
                "min_max": f"{min_max_scores[i]:.4f}"
            })
            
        analysis_stats = {
            "mean": f"{mean:.2f}",
            "std": f"{std_dev:.2f}",
            "min": f"{min_score:.2f}",
            "max": f"{max_score:.2f}"
        }

        return jsonify({
            "results": results,
            "stats": analysis_stats
        })
    except Exception as e:
        print(f"Numpy Data Generation Failed: {e}")
        return jsonify({"error": f"Internal Server Error during Numpy data generation: {str(e)}"}), 500
</code></pre>
    
